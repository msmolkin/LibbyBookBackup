# !/bin/bash

# Description: Download a book from Libby as a single HTML file
# Dependencies: monolith, wget
# Usage: ./download_book_html.sh
# Author: @msmolkin
# License: MIT
for url in "https://share.libbyapp.com/data/2cedd9ea-d865-44b8-b4a9-9da9affafa09/libbyjourney-671481-the-100-startup.html" "https://share.libbyapp.com/data/cd6474dc-1f4f-4e13-bc2f-e6f5ed1df6cd/libbyjourney-5384452-stan-lee.html" "https://share.libbyapp.com/data/c63a5b08-07f6-4fa3-9eba-33369fc172cc/libbyjourney-76374-how-to-win-friends-and-influence-people.html" "https://share.libbyapp.com/data/8e35ebcf-7363-4927-bc6a-e1ee3a9e91c0/libbyjourney-3249606-principles.html" "https://share.libbyapp.com/data/d1cea994-2913-49fd-8f9e-539889868fdf/libbyjourney-4321428-the-bhagavad-gita.html" "https://share.libbyapp.com/data/09c671be-45ae-4de3-a7ed-ac0f9cd78daf/libbyjourney-2514853-practical-steps-to-think-and-grow-rich.html" "https://share.libbyapp.com/data/a263d909-2cbd-437c-bba7-619d65f19c66/libbyjourney-3127593-think-and-grow-rich.html" "https://share.libbyapp.com/data/f848d0a6-ba50-42e9-8b2f-29ff37b14ed4/libbyjourney-1327403-how-to-be-the-perfect-gentleman.html" "https://share.libbyapp.com/data/66c81e6f-1ebb-4133-a73c-95e979bf7164/libbyjourney-3206017-principles.html" "https://share.libbyapp.com/data/7add055f-3eff-4e63-b122-11c99da65956/libbyjourney-784418-bhagavad-gita.html" "https://share.libbyapp.com/data/128268d1-52c2-4b9a-8f85-302cb791c71d/libbyjourney-6032452-the-body-keeps-the-score.html" "https://share.libbyapp.com/data/f4a80b3a-27d9-42c0-b1ce-dcc0de389624/libbyjourney-569106-how-to-make-millions-without-a-degree.html" "https://share.libbyapp.com/data/8169c170-85ca-4814-9935-06abc159e979/libbyjourney-1177769-the-essential-talmud.html" "https://share.libbyapp.com/data/bf0e8063-0af2-49d1-87fa-672e5963c453/libbyjourney-117981-the-prince.html" "https://share.libbyapp.com/data/0dcaed70-3dea-4d12-9ffc-2b09076a2d5b/libbyjourney-3488520-skin-in-the-game.html" "https://share.libbyapp.com/data/1b29ba3a-a939-47fe-9ac3-272616bbde32/libbyjourney-4837157-filled-with-fire-and-light.html" "https://share.libbyapp.com/data/e1cab0bb-5904-422e-b28b-948298b162cb/libbyjourney-3538569-skin-in-the-game.html" "https://share.libbyapp.com/data/c104960e-9c9b-4746-8755-85ce72d265d0/libbyjourney-6120579-what-color-is-your-parachute-2022.html" "https://share.libbyapp.com/data/b816dd6a-dd4b-4347-a1de-7da3ee451de9/libbyjourney-3581065-resilient.html" "https://share.libbyapp.com/data/af8be122-9136-4f8e-882a-8ac348cfc64c/libbyjourney-3390606-resilient.html" "https://share.libbyapp.com/data/d65da7a2-c8d8-4689-8075-0c55576529a0/libbyjourney-86234--what-do-you-care-what-other-people-think-.html" "https://share.libbyapp.com/data/9b6f1569-7b1c-43bd-bbd3-32798e736904/libbyjourney-647197-the-100-startup.html" "https://share.libbyapp.com/data/4a761ca6-ec25-4bcc-9f55-1f6bea27193f/libbyjourney-63301-man-s-search-for-meaning.html" "https://share.libbyapp.com/data/c9279d7a-2cf2-45ff-b27b-16511fa690a4/libbyjourney-717020-the-great-poets.html" "https://share.libbyapp.com/data/d65da7a2-c8d8-4689-8075-0c55576529a0/libbyjourney-86234--what-do-you-care-what-other-people-think-.html"
do
    chrome --headless --dump-dom $url | monolith - -ab https://share.libbyapp.com -j -o book.html
    sed -i '.bak' "s%local source%$url%" book.html
    title=$(python3 extract_notes_title.py) && mv book.html "books/$title.html"
done
rm book.html.bak